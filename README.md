# Vehicle image classification using CNN to determine vehicle make & model
##### Saiful Hasan [LinkedIn](https://www.linkedin.com/in/saifulhasan22/) [GitHub](https://github.com/saifulhasan22) 

## Problem Statement
Transportation of goods and people is a vital activity in the contemporary world and contributes to economic prosperity and quality of life. The projection of the global vehicle count is an inexact process, but studies have shown an exponential
increase. The estimated current global vehicle count is over 1.2 billion and, according to studies, __the number of vehicles will cross [2 billion](https://www.mdpi.com/2504-4990/1/2/36/pdf) in 2035 or 2040__. Due to the increasing number of vehicles, automated vehicle analysis has become an important study in many applications. In line with this, __over the recent years, Vehicle Make and Model Recognition (VMMR) has evolved into a significant important subject of study due to its importance in numerous Intelligent Transportation Systems (ITS)__. A Vehicle Make and Model Recognition (VMMR) system can provide great value in terms of vehicle monitoring and identification based on vehicle appearance in addition to the vehicles’ attached license plate typical recognition. 

As a member of a data science team of a security company, I am currently involved in a project which aims to develop an effective and precise VMMR model. Our existing vehicle surveillance system has some challenges and is not generating results with satisfactory accuracy. The accuracy of our system sometimes falls short to detect vehicle makes and models if the images are taken in an outdoor environment; if there are any shadows and reflections in captured images and due to a wide variety of available vehicle appearances, visual similarities between different models of different manufacturers, and visual similarities between different models of the same manufacturer. Hence, we want to build a new automatic vehicle surveillance system that would give us more effective and accurate results. __In this project, we intend to utilize several supervised image classification techniques to detect vehicle makers and models. We would use Accuracy as a metric for model selection process__. 

## Executive Summary
As a part of developing an effective and precise vehicle make and model recognition system, our data scientist team has decided to utilize supervised image classification techniques considering the problem nature. We utilized a convolutional neural network (CNN) model which is one of the main types of Neural Network used for image recognition and image classifications. We have collected most of the images from [vmmrdb](http://vmmrdb.cecsresearch.org/) and google images. Due to the nature of the problem, all input we have used is the raw images of cars. We have 2,080 images in total and two classes. Our model would classify if an observation is a Toyota Camry 2007 base model or not. Here, 'Toyota' is the vehicle make and 'Camry 2007' is the vehicle model. In preliminary EDA we showcased some kind of image manipulations (image augmentation) that CNN could conduct if we set it to do so. Besides, we have also showcased some samples of the images we have in our dataset. Addressing the challenges we have with our existing VMMR system, in this study we have included images taken in outdoor environments, images of cars with visual similarities between different models of different manufacturers, and images of cars with visual similarities between different models of the same manufacturer. The images we have are placed as a train set and a test set in our local directory and we have used the images directly from our directory to the CNN model. We ran the baseline model, and the CNN model with original images (without augmentation) and the CNN model with augmented images. The findings suggest that the CNN model with original images have the highest accuracy score than other models. In the later part of the study, we have also visualized and briefly explained how CNN works and investigated the image misclassifications. We recommended to take the insights from this study and move forward to the next step to train the model for multi-classifications for vehicle makes and models. Besides, our findings helped us to point out the things we need to consider in the future to improve the accuracy of the model.     

## Key Findings
Our analysis suggest that CNN model 1 has a far better accuracy rate than CNN model 2 and baseline model. **CNN model 1 has accuracy score of 89.2% on the train set and 87.1% on test set**.Moreover, the accuracy rates on the test and train sets suggest that it is not an overfitted or underfired model. CNN model 1 is the CNN model with the original image dataset. Based on the results we can conclude that in our study the CNN model with original images performs better than the CNN model with augmented images and evidently from the baseline model. Therefore, **we have selected the CNN model with original images** for further evaluation. The accuracy score on the test set and train set for CNN Model with original images have been presented below:

![graph](https://git.generalassemb.ly/saifulhasan22/capstone/blob/master/images_and_gifs/graph.png?raw=true)

## Conclusion
In this study, our model classifies whether an observation is Toyota Camry 2007 base model or not. The input of our CNN models were raw images of cars. To achieve our aim of the project we have investigated 3 models including the baseline model and two CNN models. Based on the accuracy results, we see that the CNN model with original images (without augmentations) performs better than other models. This means that The CNN model with original images predicts the highest number of observations correctly. The selected CNN model has managed to get an **accuracy of 89.2% on the train set and 87.1% on the test set**. Further investigation on model outputs and the misclassified images provides some insights that we need to take into account for further improvement of the accuracy score. 

## Recommendation
We have managed to build a model with around 87.1% accuracy, which is a pretty good result. Based on this result, we could start using the model for our intended purposes and take it to the next level. We have trained the model for binary classifications. We should take the insights from this study and take the next step to train the model for multi-classifications for vehicle makes and models. 

Besides, 12.7% of misclassifications might be a problem if we want to predict or surveil millions of cars. Therefore, we have some recommendations to improve the accuracy even further, to take it to close to 100%.

   -  We need more images. There is no alternative to having a large number of images to get better accuracy in the CNN model. Car is a very complex object and has lost of details. Hence, to train our model better we need images of around thousands. It would be better if can get thousands of images for each feature (e.g. thousands of images of the wheels alone, thousands of images of the rear mirror alone) and different angles or views (e.g.thousands of images for front view, thousands of images for back view). We need a large number of images for both target and non-target classes. 

   - If possible we could feed high-resolution images as input to the models. So, it might help the model to extract the details of the cars.

   - Images with fewer surroundings might be much better input, but if we want to predict a vehicle with other surroundings in real-time we need to feed the model with a large number of such images.   
   
   ## Reference
- [1] [Keras](https://keras.io/api/preprocessing/image/)
- [2] [Danqing Liu](https://medium.com/@danqing/a-practical-guide-to-relu-b83ca804f1f7#:~:text=ReLU%20stands%20for%20rectified%20linear,a%20type%20of%20activation%20function.&text=ReLU%20is%20the%20most%20commonly,usually%20a%20good%20first%20choice)
- [3] [Jason Brownlee](https://machinelearningmastery.com/pooling-layers-for-convolutional-neural-networks/)
- [4] [Pranoy Radhakrishnan](https://towardsdatascience.com/what-are-hyperparameters-and-how-to-tune-the-hyperparameters-in-a-deep-neural-network-d0604917584a)
- [5] [Jason Brownlee](https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/#:~:text=The%20sigmoid%20activation%20function%2C%20also,value%20between%200.0%20and%201.0.)
- [6] [Sumit Sarin](https://towardsdatascience.com/exploring-image-data-augmentation-with-keras-and-tensorflow-a8162d89b844)
- [7] [Jason Brownlee](https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/)
- [8] [vmmrdb](http://vmmrdb.cecsresearch.org/)
- [9] [Real-Time Vehicle Make and Model Recognition System](https://www.mdpi.com/2504-4990/1/2/36/pdf)
- [10] [Autolist](https://www.autolist.com/toyota-camry/toyota-camry-generations)
- [11] [Understanding of Convolutional Neural Network (CNN) — Deep Learning](https://medium.com/@RaghavPrabhu/understanding-of-convolutional-neural-network-cnn-deep-learning-99760835f148)
- [12] [Activation layer visualization](https://towardsdatascience.com/visualizing-intermediate-activation-in-convolutional-neural-networks-with-keras-260b36d60d0#:~:text=Visualizing%20intermediate%20activations%20consists%20of,output%20of%20the%20activation%20function)